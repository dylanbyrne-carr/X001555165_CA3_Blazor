@page "/"

<PageTitle>F1 Race Analytics</PageTitle>

<div class="max-w-7xl mx-auto">

    <div class="flex items-center justify-between mb-8">
        <h2 class="text-3xl font-bold">Select a Race</h2>
        <select @bind="selectedYear" @bind:after="FilterTracks"
                class="px-4 py-2 bg-f1-gray border border-gray-600 rounded focus:border-f1-red focus:outline-none">
            <option value="0">All Years</option>
            <option value="2025">2025</option>
            <option value="2024">2024</option>
            <option value="2023">2023</option>
        </select>
    </div>
    
    @if (isLoading)
    {
        <div class="text-center py-20">
            <p class="text-xl">Loading races...</p>
        </div>
    }
    else if (errorMessage != null)
    {
        <div class="bg-red-900 border border-red-700 rounded p-4 mb-6">
            <p>@errorMessage</p>
        </div>
    }
    else
    {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            @foreach (var track in filteredTracks)
            {
                <div class="bg-f1-gray rounded-lg p-4">
                
                    <div class="aspect-video bg-f1-dark rounded-lg mb-3 flex items-center justify-center overflow-hidden">
                        <img src="@track.ImageUrl" 
                             alt="@track.CircuitShortName"
                             class="w-full h-full object-contain"/>
                    </div>
                    
                    <h3 class="text-lg font-bold mb-1">@track.MeetingsByYear[track.SelectedYear].MeetingOfficialName</h3>
                    <p class="text-sm text-gray-400 mb-1">@track.CircuitShortName</p>
                    <p class="text-sm text-gray-500 mb-3">@track.CountryName</p>
                    
                    <button @onclick="() => ViewRaceResults(track)"
                            class="w-full px-4 py-2 bg-f1-red hover:bg-red-700 rounded font-medium transition">
                        View Results
                    </button>
                </div>
            }
        </div>
    }
</div>